# Bean Classification
## Goal
The goal of this work is to find a supervised model which can classify the type of bean based on measurements. 2 models were implemented and compared via a **nested cross validation** after utilizing a EDA and finding an appropriate grid for the hyperparameters. The data and its related information is taken from the [UCI Machine Learning Repo](https://archive.ics.uci.edu/dataset/602/dry+bean+dataset). 

## Summary of Outcome
In this jupyter notebook I developed a classifier in order to segmant different types of beans enabling our company to fullfill the requeirements for the ingredients of the smoothies. At first I investigated the data using IDA and EDA and could make sure that the data does not contain outliers, no missing values and has as sufficient quality for the classifiers. I used a dummy classifier and ran the a **SVM** and **AdaBoost modell with decision trees** in default and could create a already good baseline model reaching balanced accuracys more than 92%. The models were just trained on a single train test split and the balanced accuracys therefore have only a limited informative value. In the next step I investigated the hyperparameters in order to find a good hyperparameter grid for the following nested cross validation. Since the dataset is large running the nested cross validation took a long time. The AdaBoost model in particular took a very long time to calculate due to the prunning and therefore only a small hyper parameter grid could be used. The SVM, on the other hand, allowed a much larger hyperparameter grid. It turned out that the scores of the two classifiers are similar but the AdaBoost model start overfitted. I therefore decided in favor of the SVM. I then ran the SVM model on a train test split with a Grisearch for hyperparameter optimization and then examined the individual predictions of the classes with the test data set. The hyperparameter optimization showed that a linear kernel leads to the best scores, which was unexpected. When examining the classes of the predictions, it was found that all classes had similarly good scores. The highest balanced accuracy was 1 (Bombay) and the worst a few percentage points below. In the last step, I analyzed the importance of features using the permutation method. I realized that the ShapeFactor4 with the roundness seems to be the most important one and stands out significantly from the other fetures. **A balanced accuracy of approx. 93.5% was reached with the SVM.**

## Dataset Information 
The data and its related information is taken from the [UCI Machine Learning Repo](https://archive.ics.uci.edu/dataset/602/dry+bean+dataset). More information can be found in the original paper. In the research of the dataset, seven distinct types of dry beans were analyzed based on characteristics such as form, shape, type, and market-related structure. A computer vision system was created to differentiate these seven registered varieties, which share similar features, ensuring consistent seed classification. To develop the classification model, high-resolution images of 13,611 grains from the seven dry bean varieties were captured. These images underwent segmentation and feature extraction processes, resulting in the identification of 16 features, 12 related to dimensions and 4 pertaining to shape forms. The 16 features + 1 target and their meaning will be enumerated in the following.

| Feature             | Meaning                                                                                                     |
|---------------------|-------------------------------------------------------------------------------------------------------------|
| Area (A)            | The area of a bean zone and the number of pixels within its boundaries.                                     |
| Perimeter (P)       | Bean circumference defined as the length of its border.                                                     |
| Major axis length (L) | The distance between the ends of the longest line that can be drawn from a bean.                          |
| Minor axis length (l) | The longest line that can be drawn from the bean while standing perpendicular to the main axis.           |
| Aspect ratio (K)    | Defines the relationship between the major axis length (L) and minor axis length (l).                      |
| Eccentricity (Ec)   | Eccentricity of the ellipse having the same moments as the region.                                          |
| Convex area (C)     | Number of pixels in the smallest convex polygon that can contain the area of a bean seed.                   |
| Equivalent diameter (Ed) | The diameter of a circle having the same area as a bean seed area.                                     |
| Extent (Ex)         | The ratio of the pixels in the bounding box to the bean area.                                               |
| Solidity (S)        | Also known as convexity. The ratio of the pixels in the convex shell to those found in beans.               |
| Roundness (R)       | Calculated with the following formula: (4πA)/(P^2)                                                          |
| Compactness (CO)    | Measures the roundness of an object: Equivalent diameter (Ed) divided by major axis length (L).             |
| ShapeFactor1 (SF1)  | Defined as the ratio of the major axis length (L) to the area (A): $$\frac{L}{A}$$                          |
| ShapeFactor2 (SF2)  | Defined as the ratio of the minor axis length (l) to the area (A): $$\frac{l}{A}$$                          |
| ShapeFactor3 (SF3)  | Defined as the ratio of the area (A) to the product of half the major axis length (L/2) and half the minor axis length (l/2) times π: $$\frac{A}{\left(\frac{L}{2} \cdot \frac{l}{2} \cdot \pi\right)}$$ |
| ShapeFactor4 (SF4)  | Defined as the ratio of the area (A) to the product of half the minor axis length (l/2) and half the major axis length (L/2) times π: $$\frac{A}{\left(\frac{l}{2} \cdot \frac{L}{2} \cdot \pi\right)}$$ |
| Class               | The type of dry bean: Seker, Barbunya, Bombay, Cali, Dermosan, Horoz, and Sira.                             |

